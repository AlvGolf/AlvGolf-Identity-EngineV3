/*
================================================================
RESPONSIVE MODERN OPTIMIZATIONS - 2026
================================================================
Optimizaciones para iOS 18, Android 15, Windows 11
Compatible con: iPhone 16, Samsung S24, tablets, desktops
Fecha: 2026-02-07
================================================================
*/

/* ============================================================
   1. VIEWPORT Y SAFE AREAS MODERNOS (iOS con Notch/Dynamic Island)
   ============================================================ */

:root {
    /* Safe areas para iPhone con notch/Dynamic Island */
    --safe-area-inset-top: env(safe-area-inset-top, 0px);
    --safe-area-inset-right: env(safe-area-inset-right, 0px);
    --safe-area-inset-bottom: env(safe-area-inset-bottom, 0px);
    --safe-area-inset-left: env(safe-area-inset-left, 0px);

    /* Variables responsive modernas */
    --header-height: 60px;
    --footer-height: 50px;
    --touch-target-min: 44px;  /* WCAG 2.1 Level AAA */

    /* Breakpoints actualizados 2026 */
    --breakpoint-xs: 375px;   /* iPhone SE 2022 */
    --breakpoint-sm: 430px;   /* iPhone 16 Pro Max */
    --breakpoint-md: 768px;   /* iPad Mini */
    --breakpoint-lg: 1024px;  /* iPad Pro 11" */
    --breakpoint-xl: 1366px;  /* iPad Pro 12.9" / Laptops */
    --breakpoint-xxl: 1920px; /* Desktop HD */
}

/* Header con safe areas (iOS notch) */
.header {
    padding-top: max(20px, var(--safe-area-inset-top));
    padding-left: max(15px, var(--safe-area-inset-left));
    padding-right: max(15px, var(--safe-area-inset-right));
}

/* Content con safe areas laterales */
.main-content,
.tab-content {
    padding-left: max(15px, var(--safe-area-inset-left));
    padding-right: max(15px, var(--safe-area-inset-right));
    padding-bottom: max(20px, var(--safe-area-inset-bottom));
}

/* ============================================================
   2. PERFORMANCE OPTIMIZATIONS
   ============================================================ */

/* GPU acceleration para animaciones */
.tab-content,
.chart-container,
.card,
.stat-card,
.glass-card {
    transform: translateZ(0);
    will-change: auto;
    backface-visibility: hidden;
    -webkit-backface-visibility: hidden;
}

/* Lazy loading para contenido fuera de viewport */
.tab-content:not(.active) {
    content-visibility: hidden;
    contain: layout style paint;
}

/* Smooth scrolling nativo (iOS, Android, Windows 11) */
html {
    scroll-behavior: smooth;
    -webkit-overflow-scrolling: touch;
    overscroll-behavior-y: contain;
}

/* Optimizar rendering de fonts */
body {
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    text-rendering: optimizeLegibility;
}

/* ============================================================
   3. TOUCH OPTIMIZATIONS (iOS & Android)
   ============================================================ */

/* Áreas táctiles mínimas 44x44px (Apple HIG & Material Design) */
button,
a.button,
.tab-btn,
.download-btn,
.nav-btn,
.btn {
    min-height: var(--touch-target-min);
    min-width: var(--touch-target-min);
    padding: 12px 20px;
}

/* Touch feedback iOS y Android */
button,
a,
.clickable {
    -webkit-tap-highlight-color: rgba(74, 159, 216, 0.2);
    tap-highlight-color: rgba(74, 159, 216, 0.2);
    touch-action: manipulation;
}

/* Prevent text selection en elementos UI */
.tab-btn,
.download-btn,
.nav-btn,
.stat-card {
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
}

/* ============================================================
   4. CHARTS RESPONSIVE MODERNOS
   ============================================================ */

/* Charts con aspect ratio fijo */
.chart-container {
    position: relative;
    aspect-ratio: 16 / 9;
    width: 100%;
    max-height: 500px;
}

.chart-container canvas {
    width: 100% !important;
    height: 100% !important;
    max-height: inherit;
}

/* Charts en móviles pequeños */
@media (max-width: 430px) {
    .chart-container {
        aspect-ratio: 4 / 3;
        max-height: 350px;
    }
}

/* Charts en tablets */
@media (min-width: 768px) and (max-width: 1024px) {
    .chart-container {
        aspect-ratio: 16 / 10;
        max-height: 450px;
    }
}

/* ============================================================
   5. GRID & FLEXBOX MODERNOS
   ============================================================ */

/* Grid moderno con auto-fit y minmax */
.stats-grid,
.cards-grid,
.grid-container {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(min(100%, 280px), 1fr));
    gap: clamp(15px, 3vw, 25px);
    padding: clamp(10px, 2vw, 20px);
}

/* Subgrid support (Safari 16+, Chrome 117+) */
@supports (grid-template-rows: subgrid) {
    .stat-card {
        display: grid;
        grid-template-rows: subgrid;
        grid-row: span 3;
    }
}

/* ============================================================
   6. BREAKPOINTS MODERNOS 2026
   ============================================================ */

/* iPhone SE 2022 (375px) */
@media (max-width: 375px) {
    :root {
        --header-height: 50px;
        font-size: 14px;
    }

    .tab-btn {
        font-size: 0.85rem;
        padding: 10px 12px;
    }

    h1 { font-size: 1.5rem; }
    h2 { font-size: 1.25rem; }
    h3 { font-size: 1.1rem; }

    .stats-grid {
        grid-template-columns: 1fr;
    }
}

/* iPhone 16 / Galaxy S24 (430px) */
@media (min-width: 376px) and (max-width: 430px) {
    :root {
        font-size: 15px;
    }

    .stats-grid {
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    }
}

/* Smartphones grandes (430px - 768px) */
@media (min-width: 431px) and (max-width: 767px) {
    :root {
        font-size: 15px;
    }

    .stats-grid {
        grid-template-columns: repeat(2, 1fr);
    }
}

/* Tablets portrait (768px - 1024px) */
@media (min-width: 768px) and (max-width: 1024px) {
    :root {
        font-size: 16px;
        --header-height: 70px;
    }

    .tab-navigation {
        flex-wrap: nowrap;
        overflow-x: auto;
        scroll-snap-type: x mandatory;
        -webkit-overflow-scrolling: touch;
    }

    .tab-btn {
        scroll-snap-align: start;
        flex-shrink: 0;
    }

    .stats-grid {
        grid-template-columns: repeat(2, 1fr);
    }
}

/* Desktop pequeño (1024px - 1366px) */
@media (min-width: 1024px) and (max-width: 1366px) {
    .main-container {
        max-width: 1200px;
        margin: 0 auto;
    }

    .stats-grid {
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    }
}

/* Desktop grande (1366px+) */
@media (min-width: 1366px) {
    .main-container {
        max-width: 1400px;
        margin: 0 auto;
    }

    .chart-container {
        max-height: 600px;
    }

    .stats-grid {
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    }
}

/* Ultra-wide (1920px+) */
@media (min-width: 1920px) {
    .main-container {
        max-width: 1600px;
    }

    .stats-grid {
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    }
}

/* ============================================================
   7. ORIENTATION & LANDSCAPE
   ============================================================ */

/* Landscape en móviles */
@media (max-width: 768px) and (orientation: landscape) {
    :root {
        --header-height: 50px;
    }

    .header {
        position: sticky;
        top: 0;
        z-index: 1000;
    }

    .chart-container {
        max-height: 60vh;
    }

    .stats-grid {
        grid-template-columns: repeat(3, 1fr);
    }
}

/* Tablets landscape */
@media (min-width: 768px) and (max-width: 1024px) and (orientation: landscape) {
    .stats-grid {
        grid-template-columns: repeat(3, 1fr);
    }
}

/* ============================================================
   8. DARK MODE NATIVO & LIGHT MODE
   ============================================================ */

@media (prefers-color-scheme: dark) {
    :root {
        color-scheme: dark;
    }

    /* Optimizar contraste para OLED (iPhone 16 Pro, Samsung S24) */
    body {
        background: #000000;
    }
}

@media (prefers-color-scheme: light) {
    :root {
        color-scheme: light;
        --bg-primary: #FFFFFF;
        --text-primary: #1F2937;
        --text-secondary: #6B7280;
        --card-bg: rgba(255, 255, 255, 0.9);
    }

    body {
        background: linear-gradient(135deg, #F3F4F6 0%, #E5E7EB 50%, #D1D5DB 100%);
        color: var(--text-primary);
    }

    .glass-card,
    .card,
    .stat-card {
        background: var(--card-bg);
        color: var(--text-primary);
        border-color: rgba(0, 0, 0, 0.1);
    }
}

/* ============================================================
   9. ACCESSIBILITY & MOTION
   ============================================================ */

/* Reducir motion para usuarios sensibles */
@media (prefers-reduced-motion: reduce) {
    *,
    *::before,
    *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
        scroll-behavior: auto !important;
    }
}

/* Focus visible moderno (mejor que :focus) */
*:focus-visible {
    outline: 3px solid #4A9FD8;
    outline-offset: 2px;
    border-radius: 4px;
}

/* Ocultar outline en click (mouse) pero mantener en teclado */
*:focus:not(:focus-visible) {
    outline: none;
}

/* Aumentar contraste si el usuario lo prefiere */
@media (prefers-contrast: high) {
    body {
        --text-primary: #FFFFFF;
        --bg-primary: #000000;
    }

    .card,
    .stat-card {
        border-width: 2px;
    }
}

/* ============================================================
   10. SCROLLBARS CUSTOM (Windows 11, Chrome)
   ============================================================ */

/* Scrollbar styling para Windows/Chrome */
::-webkit-scrollbar {
    width: 10px;
    height: 10px;
}

::-webkit-scrollbar-track {
    background: rgba(255, 255, 255, 0.05);
    border-radius: 10px;
}

::-webkit-scrollbar-thumb {
    background: rgba(74, 159, 216, 0.5);
    border-radius: 10px;
    border: 2px solid transparent;
    background-clip: content-box;
}

::-webkit-scrollbar-thumb:hover {
    background: rgba(74, 159, 216, 0.8);
    background-clip: content-box;
}

/* Firefox scrollbar */
* {
    scrollbar-width: thin;
    scrollbar-color: rgba(74, 159, 216, 0.5) rgba(255, 255, 255, 0.05);
}

/* ============================================================
   11. PRINT STYLES
   ============================================================ */

@media print {
    body {
        background: white !important;
        color: black !important;
    }

    .header,
    .tab-navigation,
    .download-menu,
    button,
    .btn {
        display: none !important;
    }

    .tab-content {
        display: block !important;
        page-break-inside: avoid;
    }

    .chart-container {
        page-break-inside: avoid;
        max-height: 400px;
    }

    .glass-card,
    .card {
        border: 1px solid #000;
        background: #FFF !important;
    }
}

/* ============================================================
   12. HOVER EFFECTS (Desktop only)
   ============================================================ */

@media (hover: hover) and (pointer: fine) {
    .card:hover,
    .stat-card:hover,
    .glass-card:hover {
        transform: translateY(-4px);
        box-shadow: 0 8px 24px rgba(74, 159, 216, 0.3);
        transition: all 0.3s ease;
    }

    .tab-btn:hover {
        background: rgba(74, 159, 216, 0.2);
        transition: background 0.2s ease;
    }

    button:hover,
    .btn:hover {
        transform: scale(1.05);
        transition: transform 0.2s ease;
    }
}

/* ============================================================
   13. HIGH DPI / RETINA DISPLAYS
   ============================================================ */

@media (-webkit-min-device-pixel-ratio: 2),
       (min-resolution: 192dpi),
       (min-resolution: 2dppx) {
    body {
        -webkit-font-smoothing: subpixel-antialiased;
    }

    .card,
    .stat-card,
    .glass-card {
        border-width: 0.5px;
    }
}

/* ============================================================
   14. FOLDABLE DEVICES (Samsung Fold, Pixel Fold)
   ============================================================ */

@media (min-width: 600px) and (max-width: 900px) {
    .stats-grid {
        grid-template-columns: repeat(2, 1fr);
    }
}

/* ============================================================
   15. iOS SPECIFIC FIXES
   ============================================================ */

/* iOS Safari 100vh bug fix */
.full-height,
body {
    min-height: 100vh;
    min-height: -webkit-fill-available;
}

/* iOS input zoom prevention */
input,
select,
textarea,
button {
    font-size: max(16px, 1em);
}

/* ============================================================
   16. ANDROID SPECIFIC OPTIMIZATIONS
   ============================================================ */

/* Android Chrome address bar hide */
@media (max-width: 768px) {
    .header {
        position: sticky;
        top: 0;
        z-index: 100;
        backdrop-filter: blur(10px);
    }
}

/* Android scroll snap */
.tab-navigation {
    scroll-snap-type: x mandatory;
    scroll-padding: 0 15px;
}

.tab-btn {
    scroll-snap-align: start;
}

/* ============================================================
   17. UTILITY CLASSES
   ============================================================ */

/* Show/hide según dispositivo */
.mobile-only { display: none !important; }
.tablet-only { display: none !important; }
.desktop-only { display: none !important; }

@media (max-width: 767px) {
    .mobile-only { display: block !important; }
    .hide-mobile { display: none !important; }
}

@media (min-width: 768px) and (max-width: 1023px) {
    .tablet-only { display: block !important; }
    .hide-tablet { display: none !important; }
}

@media (min-width: 1024px) {
    .desktop-only { display: block !important; }
    .hide-desktop { display: none !important; }
}

/* ============================================================
   18. CONTAINER QUERIES (Chrome 105+, Safari 16+)
   ============================================================ */

@supports (container-type: inline-size) {
    .dashboard-section,
    section {
        container-type: inline-size;
        container-name: section;
    }

    @container section (min-width: 600px) {
        .chart-container {
            aspect-ratio: 16 / 9;
        }
    }

    @container section (max-width: 599px) {
        .chart-container {
            aspect-ratio: 4 / 3;
        }
    }
}

/* ============================================================
   FIN DE OPTIMIZACIONES MODERNAS 2026
   ============================================================ */
